
<!DOCTYPE html>
<html lang="ZH">
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" charset="utf-8" src="../../js/customer/resource.js"></script>
    <!--<script src="https://cdn.bootcss.com/vue-resource/1.5.0/vue-resource.min.js"></script>-->
    <link rel="stylesheet" href="../../libs/customer/index.css">
    <style type="text/css">


        .left_area {
            width: 80%;
            display: inline-block;
            height: 100%;
        }

        .right_area {
            width: 19%;
            display: inline-block;
            float: right;
            overflow-y: scroll;
            overflow-x: scroll;
            height: 8.0rem;
            border: 0.01rem solid #ddd;
        }

        .image_content {
            display: inline-block;
            width: 60%;
            margin-left: 2%;
            height: 5.0rem;
        }

        .form_content {
            float: right;
            display: inline-block;
            margin-right: 8%;
        }

        .image_content_area {
            height: 5.0rem;
        }

        .upload_input {
            display: inline-block;
            width: 2.74rem;
            position: relative;
        }

        .upload_input_btn {
            display: inline-block;
        }

        .upload_input_area {
            margin-top: 2%;
        }

        .el-input__suffix {
            right: 0;
        }

        .el-input--prefix .el-input__inner {
            padding-left: 0.15rem;
        }

        .btn_default {
            border: 0.01rem solid #FFAA00;
            background: white;
            color: #ffaa00;
            border-radius: 0.02rem;
            cursor: pointer;
            font-family: PingFangSC-Regular;
            font-size: 0.16rem;
            letter-spacing: -0.0039000000000000003rem;
            outline: none
        }

        .btn_default:hover {
            background: #FFAA00;
            color: #333333;
        }

        .query_search_btn {
            height: 0.35rem;
            width: 0.8rem;
        }

        .upload_container {
            padding-left: 1.1%
        }

        .import_btn {
            margin: 0.03rem;
        }

        .search_bth_edit {
            margin: 0.03rem;
        }

        .no_image {
            font-size: 4em;
            color: #DDDDDD;
            margin-top: 20%;
            margin-left: 25%;
        }

        .click_date {
            color: #333333;
        }

        .focus_date_bg {
            background-color: #ffaa00;
        }
        .file_name_show{
            position: absolute;
            top:0.1rem;
            display: inline-block;
            width: 1.8rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 0.16rem;
            font-family: PingFangSC-Regular !important;
            cursor: pointer;
            font-weight: 700;
        }
        .checkMsg{
            line-height: 0.2rem;
            white-space: pre-wrap;
        }
        <!--@media only screen and (max-width: 14.4rem) {-->
            <!--.image_content {-->
                <!--width: 60%;-->
                <!--margin-left: 0%;-->
                <!--height: 3.4rem;-->
            <!--}-->

            <!--.form_content {-->
                <!--margin-right: 0%;-->
            <!--}-->

            <!--.image_content_area {-->
                <!--height: 3.45rem;-->
            <!--}-->

            <!--.upload_container {-->
                <!--padding-left: 1.8%-->
            <!--}-->

            <!--.upload_input {-->
                <!--width: 2.6rem;-->
            <!--}-->
        <!--}-->
    </style>
</head>
<body>
<iframe id="ifile" style="display:none"></iframe>
<div id="rrapp" v-cloak>
    <div>
        <div class="row" style="border-top: 0.0rem;margin-bottom: 0.15rem;padding-top: 0.0rem">
            <div class="upload_container">
                <label class="el-form-item__label">选择文件:</label>
                <div class="upload_input" id="upload">
                    <button type="button" class="btn_default query_search_btn import_btn" onclick="showSelectFileWin();">
                        浏览
                    </button>
                    <span id="showFileName" class="file_name_show">
                        未选择文件
                    </span>
                    <!--<form id="submitFileForm" target="upLoadFileCallBack" method="post" onSubmit="" enctype="multipart/form-data">-->
                        <input type="file" @change="onChangeFile($event)" id="file" class="upload_input_area" style=" display: none" name="file"/>
                        <!--<input type="hidden" style=" display: none" name="token" v-model="token"/>-->
                    <!--</form>-->
                    <!--<iframe id="upLoadFileCallBack" name="upLoadFileCallBack" style="display: none;"></iframe>-->
                </div>
                <div class="upload_input_btn">
                    <button type="button" class="btn_default query_search_btn import_btn" @click="uploadFile($event)">
                    <!--<button type="button" class="btn_default query_search_btn import_btn" onclick="submitFile();">-->
                        导入
                    </button>
                    <!--<font color="red">文件上传最大2M</font>-->
                </div>
            </div>
        </div>

        <div class="left_area">
            <el-form ref="invoice" :model="invoice" label-width="1.0rem">
                <el-row>
                    <el-col :span="5">
                        <div class="form-row">
                            <el-form-item label="发票代码:" id="requireMsg1" class="form-item">
                                <el-input placeholder="请输入发票代码" v-model="invoice.invoiceCode"  maxlength="12"></el-input>
                            </el-form-item>
                        </div>
                    </el-col>
                    <el-col :span="5">
                        <div class="form-row">
                            <el-form-item label="发票号码:" id="requireMsg2" class="form-item">
                                <el-input placeholder="请输入发票号码" v-model="invoice.invoiceNo" maxlength="8"></el-input>
                            </el-form-item>
                        </div>
                    </el-col>
                    <el-col :span="5">
                        <div class="form-row">
                            <el-form-item label="开票日期:" id="requireMsg3" class="form-item">
                                <el-date-picker type="date" :clearable="false" :editable="false"
                                                :picker-options="saveInvoiceDate" id="saveKPDate"
                                                style="width: 100% !important;"
                                                @blur="removeDateStyle(1)"
                                                @focus="addDateStyle(1)"
                                                placeholder="选择开票日期" v-model="invoice.invoiceDate"></el-date-picker>
                            </el-form-item>
                        </div>
                    </el-col>
                    <el-col :span="5">
                        <div class="form-row">
                            <el-form-item label="校验码:" id="requireMsg4" class="form-item">
                                <el-input type="text" placeholder="请输入校验码" v-model="invoice.checkCode" maxlength="6"></el-input>
                            </el-form-item>
                        </div>
                    </el-col>
                    <el-col :span="1" style="margin-left: 0.15rem;width: auto">
                        <div class="form-row">
                            <button class="btn_default query_search_btn search_bth_edit" type="button" @click="saveInvoice">
                                保存
                            </button>
                        </div>
                    </el-col>
                </el-row>
            </el-form>
            <el-table height="4rem" :data="listData" :stripe="true" border fit highlight-current-row style="width: 100%; margin-top: 0.2rem">

                <el-table-column :show-overflow-tooltip="true"  type="index" width="70" align="center" label="序号"></el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="notes" label="签收描述" align="center" :formatter="formatterQsResult" placement="top-start" :show-overflow-tooltip="true">
                    <template scope="scope">
                        <div>{{ scope.row.notes }}</div>
                    </template>
                </el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="qsStatus" label="签收结果" align="center" :formatter="formatterQsStatus"></el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="invoiceCode" label="发票代码" align="left" header-align="center"></el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="invoiceNo" label="发票号码" align="left" header-align="center">
                    <template scope="scope">
                        <span>{{ scope.row.invoiceNo }}</span>
                        <el-tooltip class="item" effect="dark" placement="top-start">
                            <div slot="content" v-if="scope.row.invoiceType== '10' ">增值税电子普通发票</div>
                            <img  v-if="scope.row.invoiceType== '10'"  style="height:0.2rem;" src="../../img/einvoice.png" />
                            <div slot="content" v-if="scope.row.invoiceType== '14' ">增值税电子普通发票（通行费）</div>
                            <img  v-if="scope.row.invoiceType== '14' " style="height:0.2rem;" src="../../img/general-invoice.png" />
                        </el-tooltip>
                    </template>
                </el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="invoiceDate" label="开票日期" align="center" :formatter="formatterKprq"></el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="checkCode" label="校验码" align="center"></el-table-column>
                <el-table-column :show-overflow-tooltip="true"  property="id" label="操作" class-name="noSpotSpotSpot" class-name="noSpotSpotSpot" align="center" width="160">
                    <template scope="scope">
                        <span v-if="scope.row.scanId == null || scope.row.saveRepeat">
                            <a style="color: #c0c4cc;text-decoration: none;cursor:not-allowed;">图片</a>
                         </span>
                        <span v-else>
                            <a @click="showImageWin(scope.$index, scope.row)">图片</a>
                        </span>
                        <span v-if="(!scope.row.saveRepeat && scope.row.qsStatus == 0 && scope.row.id != null)">
                            <a @click="showUpdateWin(scope.$index, scope.row)" style="margin: 0 0.06rem;">修改</a>
                        </span>
                        <span v-else>
                            <a style="color: #c0c4cc;text-decoration: none;cursor:not-allowed;margin: 0 0.06rem;">修改</a>
                        </span>
                        <span>
                            <a @click="deleteInvoice(scope.$index, scope.row)">删除</a>
                        </span>
                    </template>
                </el-table-column>
            </el-table>
        </div>
        <div class="right_area">
            <p>导入结果：</p>
            <div id="pdfName"></div>
        </div>
    </div>
    <el-dialog title="修改" :close-on-click-modal="false" :visible.sync="updateWinShow" :before-close="beforeCloseUpdateWin" @close="" width="80%">
        <div class="image_content">
            <img id="edit_image_area" v-show="haveImageShow" style="padding: 0.3rem 0; width: 100%" src="">
            <div class="no_image" v-show="noImageShow">
                手工录入无图片
            </div>
        </div>
        <div class="form_content">
            <el-form ref="updateInvoice" :model="updateInvoice" label-width="1.0rem">
                <el-form-item label="发票代码:" class="form-item" prop="invoiceCode" :rules="[{ required: true, message: '发票代码不能为空'}]">
                    <el-input :disabled="true" v-model="updateInvoice.invoiceCode"></el-input>
                </el-form-item>
                <el-form-item label="发票号码:" class="form-item" prop="invoiceNo" :rules="[{ required: true, message: '发票号码不能为空'}]">
                    <el-input :disabled="true" v-model="updateInvoice.invoiceNo"></el-input>
                </el-form-item>
                <el-form-item label="开票日期:" class="form-item" prop="invoiceDate" :rules="[{ required: true, message: '开票日期不能为空'}]">
                    <el-date-picker type="date" :clearable="false" :editable="false" size="large" id="editKPDate"
                                    @blur="removeDateStyle(2)"
                                    @focus="addDateStyle(2)"
                                    placeholder="选择开票日期" v-model="updateInvoice.invoiceDate"></el-date-picker>
                </el-form-item>
                <el-form-item label="发票金额:" class="form-item">
                    <el-input v-model="updateInvoice.invoiceAmount" @blur="checkInvoiceAmount"></el-input>
                </el-form-item>
                <el-form-item label="校验码:" class="form-item" prop="checkCode" :rules="[{ required: true, message: '校验码不能为空'}]">
                    <el-input v-model="updateInvoice.checkCode"  maxlength="6"></el-input>
                </el-form-item>
            </el-form>
        </div>
        <span slot="footer" class="dialog-footer">
            <button type="button" style="background-color: white" class="btn btnexport" @click="updateWinShow = false">取 消</button>
            <button type="button" style="background-color: white" class="btn btnexport" @click="checkUpdateMsg">保存</button>
        </span>
    </el-dialog>

    <el-dialog title="图片" :visible.sync="imageShow" :close-on-click-modal="false" :before-close="beforeCloseImgWin">
        <div class="image_content_area">
            <img id="get_image_area" style="width: 100%" src="">
        </div>

        <span slot="footer" class="dialog-footer">
            <button class="btn btnexport" style="background-color: white" type="button" @click="imageShow = false">关 闭</button>
        </span>
    </el-dialog>

</div>
</body>
</html>
<script src="../../js/modules/einvoice/einvoiceload.js"></script>