<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xforceplus.wapp.modules.base.dao.GlTypeDao">

	<select id="queryObject" resultType="com.xforceplus.wapp.modules.base.entity.GlTypeEntity">
		/**mycat:schema=${schemaLabel}*/ select * from t_ac_gl_type where id = #{id}
	</select>

	<select id="queryList" resultType="com.xforceplus.wapp.modules.base.entity.GlTypeEntity">
		/**mycat:schema=${schemaLabel}*/

		<if test="entity.offset != null and entity.limit != null">
			SELECT
			TOP (#{entity.limit}) A.*
			FROM
			(
			SELECT
			row_number () OVER (ORDER BY  id desc) AS rownumber, o.*
			FROM
			(
		</if>


		select r.*  from t_ac_gl_type r
		<where>
			<if test="entity.remark != null and entity.remark.trim()!= ''">
				and r. remark  like concat('%',#{entity.remark},'%')
			</if>
			<if test="entity.matchName1 != null and entity.matchName1.trim() != ''">
				and r. match_name1  like concat('%',#{entity.matchName1},'%')
			</if>
			<if test="entity.matchName2 != null and entity.matchName2.trim() != ''">
				and r. match_name2  like concat('%',#{entity.matchName2},'%')
			</if>
			<if test="entity.glName != null and entity.glName.trim() != ''">
				and r. gl_name  like concat('%',#{entity.glName},'%')
			</if>
		</where>

		<if test="entity.offset != null and entity.limit != null">
			)
			AS o
			)A
			WHERE
			rownumber >#{entity.offset}

		</if>
	</select>

	<select id="queryTotal" resultType="int">
		/**mycat:schema=${schemaLabel}*/ select count(*) from t_ac_gl_type r
		<where>
			<if test="entity.remark != null and entity.remark.trim()!= ''">
				and r. remark  like concat('%',#{entity.remark},'%')
			</if>
			<if test="entity.matchName1 != null and entity.matchName1.trim() != ''">
				and r. match_name1  like concat('%',#{entity.matchName1},'%')
			</if>
			<if test="entity.matchName2 != null and entity.matchName2.trim() != ''">
				and r. match_name2  like concat('%',#{entity.matchName2},'%')
			</if>
			<if test="entity.glName != null and entity.glName.trim() != ''">
				and r. gl_name  like concat('%',#{entity.glName},'%')
			</if>
		</where>
	</select>
	<select id="queryExcelList" resultType="com.xforceplus.wapp.modules.base.entity.GlTypeEntity">


		<if test="entity.offset != null and entity.limit != null">
			SELECT
			TOP (#{entity.limit}) A.*
			FROM
			(
			SELECT
			row_number () OVER (ORDER BY  id desc) AS rownumber, o.*
			FROM
			(
		</if>


		select r.*  from t_ac_gl_type r
		<where>
			<if test="entity.remark != null and entity.remark.trim()!= ''">
				and r. remark  like concat('%',#{entity.remark},'%')
			</if>
			<if test="entity.matchName1 != null and entity.matchName1.trim() != ''">
				and r. match_name1  like concat('%',#{entity.matchName1},'%')
			</if>
			<if test="entity.matchName2 != null and entity.matchName2.trim() != ''">
				and r. match_name2  like concat('%',#{entity.matchName2},'%')
			</if>
		</where>

		<if test="entity.offset != null and entity.limit != null">
			)
			AS o
			)A
			WHERE
			rownumber >#{entity.offset}

		</if>
	</select>
	<select id="billtypeTotal" resultType="int">
		/**mycat:schema=${schemaLabel}*/ select count(*) from t_ac_gl_type

	</select>

	<insert id="save" parameterType="com.xforceplus.wapp.modules.base.entity.GlTypeEntity" useGeneratedKeys="true" keyProperty="entity.id">
		/**mycat:schema=${schemaLabel}*/ insert into t_ac_gl_type
		(
  			   remark ,
  			   match_name1 ,
		       match_name2,
		       gl_type,
		       gl_name
		)
		values
		(
			  #{entity.remark},
			  #{entity.matchName1},
			  #{entity.matchName2},
			  #{entity.glType},
			  #{entity.glName}
		)
	</insert>

	<update id="update" parameterType="com.xforceplus.wapp.modules.base.entity.GlTypeEntity">
		/**mycat:schema=${schemaLabel}*/ update t_ac_gl_type
		<set>
			<if test="entity.remark != null"> remark  = #{entity.remark},</if>
			<if test="entity.matchName1 != null"> match_name1  = #{entity.matchName1}, </if>
			<if test="entity.matchName2 != null"> match_name2  = #{entity.matchName2},</if>
			<if test="entity.glType != null"> gl_type  = #{entity.glType},</if>
			<if test="entity.glName != null"> gl_name  = #{entity.glName}</if>
		</set>
		where id = #{entity.id}
	</update>

	<update id="delete">
		/**mycat:schema=${schemaLabel}*/ delete from  t_ac_gl_type where id = #{id}
	</update>

	<delete id="deleteBatch" parameterType="int">
		/**mycat:schema=${schemaLabel}*/ delete from t_ac_gl_type where id in
		<foreach item="id" collection="ids" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>
	
	<select id="queryByNameAndCode" resultType="java.lang.Integer">
		/**mycat:schema=${schemaLabel}*/
		SELECT 
			COUNT(id)
		FROM
		t_ac_gl_type
		WHERE 1=1
		<if test="remark != null" >
		and remark  = #{remark}
		 </if>
		<if test="matchName1 != null">
		and match_name1  = #{matchName1}
		  </if>
		<if test="matchName2 != null">
		and match_name2  = #{matchName2}
		 </if>
		<if test="glType != null">
		and gl_type  = #{glType}
		</if>
		<if test="glName != null">
			and gl_name  = #{glName}
		</if>
		<if test="id != null and id != ''">
		and id != #{id}
		</if>
	</select>

</mapper>