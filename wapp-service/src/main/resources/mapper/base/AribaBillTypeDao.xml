<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xforceplus.wapp.modules.base.dao.AribaBillTypeDao">

	<select id="queryObject" resultType="com.xforceplus.wapp.modules.base.entity.AribaBillTypeEntity">
		/**mycat:schema=${schemaLabel}*/ select * from t_ac_ariba_billtype where id = #{id}
	</select>

	<select id="queryList" resultType="com.xforceplus.wapp.modules.base.entity.AribaBillTypeEntity">
		/**mycat:schema=${schemaLabel}*/

		<if test="entity.offset != null and entity.limit != null">
			SELECT
			TOP (#{entity.limit}) A.*
			FROM
			(
			SELECT
			row_number () OVER (ORDER BY  id desc) AS rownumber, o.*
			FROM
			(
		</if>


		select r.*  from t_ac_ariba_billtype r
		<where>
			<if test="entity.serviceName != null and entity.serviceName.trim()!= ''">
				and r. service_name  like concat('%',#{entity.serviceName},'%')
			</if>
			<if test="entity.mccCode != null and entity.mccCode.trim() != ''">
				and r. mcc_code  like concat('%',#{entity.mccCode},'%')
			</if>
			<if test="entity.glAccount != null and entity.glAccount.trim() != ''">
				and r. gl_account  like concat('%',#{entity.glAccount},'%')
			</if>
		</where>

		<if test="entity.offset != null and entity.limit != null">
			)
			AS o
			)A
			WHERE
			rownumber >#{entity.offset}

		</if>
	</select>

	<select id="queryTotal" resultType="int">
		/**mycat:schema=${schemaLabel}*/ select count(*) from t_ac_ariba_billtype r
		<where>
			<if test="entity.serviceName != null and entity.serviceName.trim()!= ''">
				and r. service_name  like concat('%',#{entity.serviceName},'%')
			</if>
			<if test="entity.mccCode != null and entity.mccCode.trim() != ''">
				and r. mcc_code  like concat('%',#{entity.mccCode},'%')
			</if>
			<if test="entity.glAccount != null and entity.glAccount.trim() != ''">
				and r. gl_account  like concat('%',#{entity.glAccount},'%')
			</if>
		</where>
	</select>
	<select id="queryExcelList" resultType="com.xforceplus.wapp.modules.base.entity.AribaBillTypeEntity">


		<if test="entity.offset != null and entity.limit != null">
			SELECT
			TOP (#{entity.limit}) A.*
			FROM
			(
			SELECT
			row_number () OVER (ORDER BY  id desc) AS rownumber, o.*
			FROM
			(
		</if>


		select r.*  from t_ac_ariba_billtype r
		<where>
			<if test="entity.serviceName != null and entity.serviceName.trim()!= ''">
				and r. service_name  like concat('%',#{entity.serviceName},'%')
			</if>
			<if test="entity.mccCode != null and entity.mccCode.trim() != ''">
				and r. mcc_code  like concat('%',#{entity.mccCode},'%')
			</if>
			<if test="entity.glAccount != null and entity.glAccount.trim() != ''">
				and r. gl_account  like concat('%',#{entity.glAccount},'%')
			</if>
		</where>

		<if test="entity.offset != null and entity.limit != null">
			)
			AS o
			)A
			WHERE
			rownumber >#{entity.offset}

		</if>
	</select>
	<select id="billtypeTotal" resultType="int">
		/**mycat:schema=${schemaLabel}*/ select count(*) from t_ac_ariba_billtype

	</select>

	<insert id="save" parameterType="com.xforceplus.wapp.modules.base.entity.AribaBillTypeEntity" useGeneratedKeys="true" keyProperty="entity.id">
		/**mycat:schema=${schemaLabel}*/ insert into t_ac_ariba_billtype
		(
  			   mcc_code ,
  			   gl_account ,
		       service_name,
		       service_type
		)
		values
		(
			  #{entity.mccCode},
			  #{entity.glAccount},
			  #{entity.serviceName},
			  #{entity.serviceType}
		)
	</insert>

	<update id="update" parameterType="com.xforceplus.wapp.modules.base.entity.AribaBillTypeEntity">
		/**mycat:schema=${schemaLabel}*/ update t_ac_ariba_billtype
		<set>
			<if test="entity.serviceName != null"> service_name  = #{entity.serviceName},</if>
			<if test="entity.mccCode != null"> mcc_code  = #{entity.mccCode}, </if>
			<if test="entity.glAccount != null"> gl_account  = #{entity.glAccount},</if>
			<if test="entity.glAccount != null"> service_type  = #{entity.serviceType}</if>
		</set>
		where id = #{entity.id}
	</update>
	<update id="updateImport" parameterType="com.xforceplus.wapp.modules.base.entity.AribaBillTypeEntity">
		/**mycat:schema=${schemaLabel}*/ update t_ac_ariba_billtype
		<set>
			<if test="entity.serviceName != null"> service_name  = #{entity.serviceName},</if>
			<if test="entity.serviceType != null"> service_type  = #{entity.serviceType}</if>
		</set>
		where mcc_code  = #{entity.mccCode} and gl_account  = #{entity.glAccount}
	</update>
	<update id="delete">
		/**mycat:schema=${schemaLabel}*/ delete from  t_ac_ariba_billtype where id = #{id}
	</update>

	<delete id="deleteBatch" parameterType="int">
		/**mycat:schema=${schemaLabel}*/ delete from t_ac_ariba_billtype where id in
		<foreach item="id" collection="ids" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>
	
	<select id="queryByNameAndCode" resultType="java.lang.Integer">
		/**mycat:schema=${schemaLabel}*/
		SELECT 
			COUNT(id)
		FROM
		t_ac_ariba_billtype
		WHERE 
		 mcc_code = #{code}
		and gl_account=#{account}
		<if test="id != null and id != ''">
			and id != #{id}
		</if>
	</select>
	<select id="queryServiceName" resultType="java.lang.String">
		SELECT
		service_name
		FROM
		t_ac_ariba_billtype
		WHERE
	    mcc_code = #{code}
		and gl_account=#{account}
	</select>
</mapper>