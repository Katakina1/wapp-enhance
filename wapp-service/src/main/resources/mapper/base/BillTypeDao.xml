<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xforceplus.wapp.modules.base.dao.BillTypeDao">

	<select id="queryObject" resultType="com.xforceplus.wapp.modules.base.entity.BillTypeEntity">
		/**mycat:schema=${schemaLabel}*/ select * from t_ac_billtype where billtypeid = #{billtypeid}
	</select>

	<select id="queryList" resultType="com.xforceplus.wapp.modules.base.entity.BillTypeEntity">
		/**mycat:schema=${schemaLabel}*/

		<if test="entity.offset != null and entity.limit != null">
			SELECT
			TOP (#{entity.limit}) A.*
			FROM
			(
			SELECT
			row_number () OVER (ORDER BY   billtypeid desc) AS rownumber, o.*
			FROM
			(
		</if>


		select r.*  from t_ac_billtype r
		<where>
			<if test="entity.billtypename != null and entity.billtypename.trim()!= ''">
				and r. billtypename  like concat('%',#{entity.billtypename},'%')
			</if>
			<if test="entity.billtypecode != null and entity.billtypecode.trim() != ''">
				and r. billtypecode  like concat('%',#{entity.billtypecode},'%')
			</if>
			<if test="entity.createBy != null"> and r. create_by  = #{entity.createBy} </if>
		</where>

		<if test="entity.offset != null and entity.limit != null">
			)
			AS o
			)A
			WHERE
			rownumber >#{entity.offset}

		</if>
	</select>

	<select id="queryTotal" resultType="int">
		/**mycat:schema=${schemaLabel}*/ select count(*) from t_ac_billtype r
		<where>
			<if test="entity.billtypename != null and entity.billtypename.trim()!= ''">
				and r. billtypename  like concat('%',#{entity.billtypename},'%')
			</if>

			<if test="entity.billtypecode != null and entity.billtypecode.trim() != ''">
				and r. billtypecode =#{entity.billtypecode}
			</if>
			<if test="entity.createBy != null"> and r. create_by  = #{entity.createBy} </if>
		</where>
	</select>

	<select id="billtypeTotal" resultType="int">
		/**mycat:schema=${schemaLabel}*/ select count(*) from t_ac_billtype

	</select>

	<insert id="save" parameterType="com.xforceplus.wapp.modules.base.entity.BillTypeEntity" useGeneratedKeys="true" keyProperty="entity.billtypeid">
		/**mycat:schema=${schemaLabel}*/ insert into t_ac_billtype
		(

  			   billtypename ,
  			   billtypecode ,
		<if test="entity.billtypedesc != null and entity.billtypedesc != ''">billtypedesc,</if>
  			   billtypetype ,
  			   create_time ,
  			   create_by ,
  			   last_modify_time ,
  			   last_modify_by
		)
		values
		(

			  #{entity.billtypename},
			  #{entity.billtypecode},
		<if test="entity.billtypedesc != null and entity.billtypedesc != ''">#{entity.billtypedesc},</if>

			  #{entity.billtypetype},
			  #{entity.createTime},
			  #{entity.createBy},
			  #{entity.lastModifyTime},
			  #{entity.lastModifyBy}
		)
	</insert>

	<update id="update" parameterType="com.xforceplus.wapp.modules.base.entity.BillTypeEntity">
		/**mycat:schema=${schemaLabel}*/ update t_ac_billtype
		<set>
			<if test="entity.billtypename != null"> billtypename  = #{entity.billtypename},</if>
			<if test="entity.billtypecode != null"> billtypecode  = #{entity.billtypecode}, </if>
			<if test="entity.billtypedesc != null"> billtypedesc  = #{entity.billtypedesc},</if>
			<if test="entity.billtypetype != null"> billtypetype  = #{entity.billtypetype}, </if>
			<if test="entity.lastModifyTime != null"> last_modify_time  = #{entity.lastModifyTime}, </if>
			<if test="entity.lastModifyBy != null"> last_modify_by  = #{entity.lastModifyBy}, </if>
		</set>
		where billtypeid = #{entity.billtypeid}
	</update>

	<update id="delete">
		/**mycat:schema=${schemaLabel}*/ delete from  t_ac_billtype where billtypeid = #{billtypeid}
	</update>

	<delete id="deleteBatch" parameterType="int">
		/**mycat:schema=${schemaLabel}*/ delete from t_ac_billtype where billtypeid in
		<foreach item="id" collection="ids" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>
	
	<select id="queryByNameAndCode" resultType="java.lang.Integer">
		/**mycat:schema=${schemaLabel}*/
		SELECT 
			COUNT(billtypeid) 
		FROM 
			t_ac_billtype
		WHERE 
		(billtypename = #{name} OR billtypecode = #{code})
		<if test="billTypeId != null and billTypeId != ''">
			and billtypeid != #{billTypeId}
		</if>
	</select>

</mapper>