<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xforceplus.wapp.modules.base.dao.DataAmendDao">


<select id="queryList" resultType="com.xforceplus.wapp.modules.base.entity.DataAmendEntity">
    SELECT
    <if test=" map.limit != null">
        TOP (#{map.limit})
    </if>
    A.*
    FROM
    (
    SELECT
    row_number () OVER (ORDER BY o.id ) AS rownumber ,o.*
    FROM
    (
    select
    id            id,
    dictdeta_no   dictdetaNo,
    on_off        onOff,
    amend_date    amendDate

    from t_ac_dictdeta_amend
    ) AS o
    ) A
    WHERE 1=1
    <if test="map.offset != null ">
        and   rownumber > #{map.offset}
    </if>
</select>


<select id="queryListCount" resultType="Integer">
    select count(1)
    from t_ac_dictdeta_amend where 1 = 1
</select>



<!--<update id="updateCopyData">-->
    <!--/**mycat:schema=${schemaLabel}*/-->
    <!--UPDATE   t_dx_invoice_del-->
    <!--SET-->
    <!--invoice_type= #{r.invoiceType} ,-->
    <!--invoice_code= #{r.invoiceCode},-->
    <!--invoice_no =#{r.invoiceNo},-->
    <!--invoice_date = #{r.invoiceDate},-->
    <!--gf_tax_no = #{r.gfTaxNo},-->
    <!--invoice_amount=  #{r.invoiceAmount},-->
    <!--tax_amount=  #{r.taxAmount},-->
    <!--total_amount =  #{r.totalAmount},-->
    <!--xf_tax_no=  #{r.xfTaxNo},-->
    <!--qs_date=#{r.signInDate},-->
    <!--uuid=#{uuid},-->
    <!--valid=0,-->
    <!--create_date=NOW(),-->
    <!--user_account = #{user.loginname},-->
    <!--user_name = #{user.username},-->
    <!--invoice_status = #{r.qsStatus},-->
    <!--inside_outside = 0-->
    <!--WHERE uuid=#{uuid}-->
<!--</update>-->

<!--parameterType="com.xforceplus.wapp.modules.base.entity.DataAmendEntity"-->
<update id="updates" parameterType="com.xforceplus.wapp.modules.base.entity.DataAmendEntity">
    update t_ac_dictdeta_amend
    set
        on_off = #{onOff},
        amend_date = CONVERT(varchar,GETDATE(),120)
    where id = #{id}
</update>
</mapper>