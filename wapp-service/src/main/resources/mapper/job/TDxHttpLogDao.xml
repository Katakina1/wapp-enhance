<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xforceplus.wapp.modules.job.dao.TDxHttpLogDao" >

        <insert id="insertHttpLog"  useGeneratedKeys="true" keyProperty="httpLog.logId" >
        insert into t_dx_http_log WITH(ROWLOCK) (
              taxno,type,req_date,req_text,res_date,res_text,status
        )
        values (
              #{httpLog.taxno},
              #{httpLog.type},
              #{httpLog.reqDate ,jdbcType=TIMESTAMP},
              #{httpLog.reqText},
              #{httpLog.resDate,jdbcType=TIMESTAMP},
              #{httpLog.resText},
              #{httpLog.status}
        )

        </insert>

        <select id="selectHttpLogById"  resultType="com.xforceplus.wapp.modules.job.entity.TDxHttpLog">
            select log_id logId ,taxno,type,req_date reqDate,req_text reqText ,res_date resDate ,res_text resText ,status from t_dx_http_log WITH(NOLOCK)
            where log_id = #{httpLogId}
        </select>

        <update id="updateHttoLogById"  >
            update t_dx_http_log WITH(ROWLOCK) set status = #{tDxHttpLog.status},total =#{tDxHttpLog.total} where log_id = #{tDxHttpLog.logId}
        </update>

        <select id="getNotParseHttpLogs" resultType="com.xforceplus.wapp.modules.job.entity.TDxHttpLog">
            select top(300) log_id, taxno,type,req_date,req_text,res_date,res_text,status from t_dx_http_log WITH(NOLOCK) where type=#{type} and  status='0'

        </select>
</mapper>