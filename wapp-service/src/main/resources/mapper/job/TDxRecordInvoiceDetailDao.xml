<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xforceplus.wapp.modules.job.dao.TDxRecordInvoiceDetailDao" >
    <insert id="insertRecordInvoiceDetail" parameterType="com.xforceplus.wapp.modules.job.entity.TDxRecordInvoiceDetail">
    	insert into t_dx_record_invoice_detail WITH(ROWLOCK) (
    	uuid,
    	invoice_code,
    	invoice_no,
    		detail_no,
    		goods_name,
    		model,
    		unit,
    		num,
    		unit_price,
    		detail_amount,
    		tax_rate,
    		tax_amount

			 )values(
			 #{invoiceDetailInfo.uuid},
			 #{invoiceDetailInfo.invoiceCode},
			 #{invoiceDetailInfo.invoiceNo},
				 #{invoiceDetailInfo.detailNo},
				 #{invoiceDetailInfo.goodsName},
				 #{invoiceDetailInfo.model},
				 #{invoiceDetailInfo.unit},
				 #{invoiceDetailInfo.num},
				 #{invoiceDetailInfo.unitPrice},
				 #{invoiceDetailInfo.detailAmount},
				 #{invoiceDetailInfo.taxRate},
				 #{invoiceDetailInfo.taxAmount}

				 )
    </insert>
	<insert id="insertRecordInvoiceDetail1" >
		insert into t_dx_record_invoice_detail WITH(ROWLOCK) (
		uuid,
		invoice_code,
		invoice_no,
		detail_no,
		goods_name,
		model,
		unit,
		num,
		unit_price,
		detail_amount,
		tax_rate,
		tax_amount

		)values
		<foreach item="info" collection="invoiceDetailInfo" separator="," >
			(#{info.uuid},
			#{info.invoiceCode},
			#{info.invoiceNo},
			#{info.detailNo},
			#{info.goodsName},
			#{info.model},
			#{info.unit},
			#{info.num},
			#{info.unitPrice},
			#{info.detailAmount},
			#{info.taxRate},
			#{info.taxAmount})
		</foreach>




	</insert>

	<delete id="delDetail" parameterType="java.lang.String">
		 
	  delete from t_dx_record_invoice_detail WITH(ROWLOCK) where uuid =#{uuid}

	</delete>


	<select id="getDetail" parameterType="java.lang.String" resultType="java.lang.Integer">
		
	  select count(1) from t_dx_record_invoice_detail WITH(NOLOCK) where uuid =#{uuid}


	</select>


	<update id="updateDetailYesorno" parameterType="com.xforceplus.wapp.modules.job.entity.TDxRecordInvoice">
		
		update t_dx_record_invoice WITH(ROWLOCK) set detail_yesorno=#{invoiceInfo.detailYesorno} where uuid=#{invoiceInfo.uuid}
	</update>



	<delete id="delDetailTaxRate" parameterType="java.lang.String">
	
	  delete from t_dx_record_invoice_statistics WITH(ROWLOCK) where invoice_code=#{invoiceCode} and  invoice_no = #{invoiceNo}

	</delete>


	<select id="getTaxRate" parameterType="java.lang.String" resultType="java.lang.Integer">
		
	  	select count(1) from t_dx_record_invoice_statistics WITH(NOLOCK) where invoice_code=#{invoiceCode} and  invoice_no = #{invoiceNo}

	</select>



	<delete id="delDetailJd" parameterType="java.lang.String">

	  delete from t_dx_vehicle_sale_invoice where uuid =#{uuid}

	</delete>

	<select id="getDetailJd" parameterType="java.lang.String" resultType="java.lang.Integer">

	  select count(1) from t_dx_vehicle_sale_invoice where uuid =#{uuid}


	</select>


</mapper>